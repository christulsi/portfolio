---
import { getCollection } from 'astro:content';

const experienceEntries = await getCollection('experiences');
const experiences = experienceEntries.map((entry) => entry.data);
---

<section id="experience" class="py-20 bg-transparent relative">
  <!-- Decorative background elements -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div
      class="absolute top-40 -left-32 w-80 h-80 bg-cyan-300/20 dark:bg-cyan-500/10 rounded-full blur-3xl"
    >
    </div>
  </div>

  <div class="container relative z-10">
    <h2 class="fade-in text-4xl text-center mb-16">Work Experience</h2>
    <div
      class="timeline relative max-w-3xl mx-auto before:content-[''] before:absolute before:left-5 before:top-0 before:bottom-0 before:w-0.5 before:bg-gray-200 before:dark:bg-gray-700 md:before:left-5"
    >
      {
        experiences.map((exp, index) => (
          <div
            class={`timeline-item relative pl-16 mb-12 md:pl-16 group animate-fade-in-up-${index + 1}`}
          >
            <div class="timeline-marker absolute left-[11px] top-0 w-5 h-5 rounded-full bg-gradient-to-br from-primary to-secondary border-[3px] border-white dark:border-gray-900 shadow-[0_0_0_4px_rgba(59,130,246,0.2)] dark:shadow-[0_0_0_4px_rgba(59,130,246,0.3)] md:left-[11px] group-hover:scale-125 transition-all duration-500 group-hover:shadow-[0_0_0_6px_rgba(59,130,246,0.3)]" />
            <div class="relative bg-white/60 dark:bg-gray-800/40 backdrop-blur-xl border border-white/20 dark:border-gray-700/50 rounded-3xl p-8 transition-all duration-500 hover:-translate-y-1 hover:shadow-2xl hover:shadow-primary/10 dark:hover:shadow-primary/20 overflow-hidden">
              {/* Gradient accent left bar */}
              <div class="absolute top-0 left-0 bottom-0 w-1.5 bg-gradient-to-b from-primary via-purple-500 to-secondary rounded-l-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500" />

              <div class="flex justify-between items-start flex-wrap gap-2 mb-2">
                <h3 class="text-2xl m-0 font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-300 bg-clip-text text-transparent">
                  {exp.title}
                </h3>
                <span class="px-4 py-1.5 bg-gradient-to-r from-primary/10 to-secondary/10 dark:from-primary/20 dark:to-secondary/20 text-primary font-semibold text-sm rounded-full border border-primary/20">
                  {exp.period}
                </span>
              </div>
              <p class="text-gray-700 dark:text-gray-300 font-semibold mb-4">{exp.company}</p>
              <p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-6">{exp.description}</p>
              <ul class="list-none p-0 space-y-2">
                {exp.achievements.map((achievement, achIndex) => (
                  <li
                    class={`text-gray-700 dark:text-gray-300 pl-7 relative before:content-['âœ“'] before:absolute before:left-0 before:text-primary before:font-bold before:text-lg animate-fade-in-up-${Math.min(index * 4 + achIndex + 1, 12)}`}
                  >
                    {achievement}
                  </li>
                ))}
              </ul>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
